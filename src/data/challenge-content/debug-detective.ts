import type { Challenge, DebugDetectivePayload } from '../challenges';

export const debugDetectiveChallenges: Challenge[] = [
  {
    id: 'dd-1',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Vague Request',
    brief: 'This prompt is too vague and got a useless response. Find the bugs.',
    difficulty: 1,
    chapterLink: 2,
    payload: {
      prompt: 'Write something about dogs for my project.',
      badOutput: 'Dogs are wonderful animals that have been companions to humans for thousands of years. There are many breeds of dogs, each with unique characteristics. Some popular breeds include Labrador Retrievers, German Shepherds, and Golden Retrievers. Dogs are known for their loyalty and can be trained to perform various tasks. Many people consider dogs to be man\'s best friend.\n\n[Generic 5-paragraph essay about dogs that could have been written about any topic]',
      bugs: [
        { region: 'Write something', bugType: 'ambiguous' },
        { region: 'about dogs', bugType: 'missing-context' },
        { region: 'for my project', bugType: 'ambiguous' },
      ],
      fixedPrompt: 'Write a 200-word informational section about how dogs use body language to communicate emotions, for my 8th grade science poster on animal behavior. Include 3 specific body language signals (tail position, ear position, posture) with what each one means. Use simple language with a friendly tone.',
      explanation: 'This prompt fails in three ways: (1) "Write something" gives zero direction — an essay? a poem? a list? (2) "About dogs" is a massive topic with no focus area, (3) "For my project" tells the AI nothing about the format, audience, length, or purpose. The fixed version specifies: the exact subtopic (body language communication), format (200-word section for a poster), context (8th grade science), structure (3 signals with explanations), and tone. The more specific you are, the less the AI has to guess.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-2',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Contradiction',
    brief: 'This prompt contradicts itself and confused the AI. Spot the conflicts.',
    difficulty: 1,
    chapterLink: 2,
    payload: {
      prompt: 'Write a very brief, comprehensive analysis of all the themes in Hamlet. Keep it short but make sure to cover everything in detail. Use simple language but maintain an academic tone. This should be no more than 100 words but include specific quotes and examples for each theme.',
      badOutput: 'Hamlet explores revenge (Hamlet vs. Claudius), death/mortality (the gravedigger scene), corruption ("Something is rotten in the state of Denmark"), appearance vs. reality (the play within the play), and madness (Ophelia, Hamlet\'s "antic disposition"). It also touches on loyalty, family duty, and the impossibility of action.\n\n[Output awkwardly tries to compress everything, resulting in a superficial list that satisfies none of the contradictory requirements]',
      bugs: [
        { region: 'very brief, comprehensive analysis of all the themes', bugType: 'contradictory' },
        { region: 'Keep it short but make sure to cover everything in detail', bugType: 'contradictory' },
        { region: 'simple language but maintain an academic tone', bugType: 'contradictory' },
        { region: 'no more than 100 words but include specific quotes and examples for each theme', bugType: 'contradictory' },
      ],
      fixedPrompt: 'Analyze the TWO most important themes in Hamlet: revenge and appearance vs. reality. For each theme: state the theme in one sentence, give one specific example from the play with a short quote, and explain its significance in 2-3 sentences. Total length: 250-300 words. Tone: clear and analytical, suitable for a high school English class.',
      explanation: 'This prompt is a pile of contradictions: brief vs. comprehensive, short vs. detailed, simple vs. academic, 100 words vs. quotes for each theme (Hamlet has 8+ major themes — that\'s 12 words per theme including quotes!). When you give the AI conflicting instructions, it tries to satisfy all of them and satisfies none. The fix: pick your priorities. You can\'t have everything, so choose what matters most. Two themes with depth beats eight themes with nothing.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-3',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Kitchen Sink',
    brief: 'This prompt tries to do too many things at once. Diagnose the overload.',
    difficulty: 2,
    chapterLink: 2,
    payload: {
      prompt: 'I need you to write a research paper about climate change, create a bibliography, design a presentation outline, write speaker notes for each slide, suggest 5 discussion questions, make a study guide for the test, and also create a poster layout. This is for my AP Environmental Science class and it\'s due Friday.',
      badOutput: 'Here\'s a brief overview of climate change for your research paper:\n\nClimate change refers to long-term shifts in temperatures and weather patterns...\n\n[The AI starts the research paper, includes a partial bibliography, begins an outline for 3 slides, then seems to forget about the speaker notes, discussion questions, study guide, and poster. The output is 40% of a research paper and fragments of the other tasks.]',
      bugs: [
        { region: 'write a research paper about climate change, create a bibliography, design a presentation outline, write speaker notes for each slide, suggest 5 discussion questions, make a study guide for the test, and also create a poster layout', bugType: 'too-many-tasks' },
        { region: 'about climate change', bugType: 'missing-context' },
      ],
      fixedPrompt: 'Step 1 of 7: Write a 1000-word research paper about the impact of ocean acidification on coral reef ecosystems for my AP Environmental Science class. Include: an introduction with a hook, 3 body paragraphs (causes, current effects, future projections), and a conclusion with a call to action. Use at least 4 scientific sources and cite them in APA format. Tone: formal and evidence-based.\n\n[Then follow up with separate prompts for each subsequent task, referencing the completed work.]',
      explanation: 'This prompt asks for SEVEN different deliverables in a single message. The AI can\'t hold all of them in focus at once — it starts the biggest task (the paper) and either forgets or gives scraps for the rest. Additionally, "climate change" is too broad — that\'s an entire field of science. The fix has two parts: (1) Break it into sequential, numbered requests — one task per prompt, (2) Narrow the topic from "climate change" to a specific aspect. Treat the AI like a focused collaborator, not a magic wish machine. One task. One prompt. Build on each output.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-4',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Leading Witness',
    brief: 'This prompt leads the AI toward a biased answer. Spot the manipulation.',
    difficulty: 2,
    chapterLink: 9,
    payload: {
      prompt: 'Everyone knows that remote work is clearly superior to office work in every way. Can you explain all the reasons why working from home is better and why companies that force people back to the office are making a terrible mistake?',
      badOutput: 'You\'re right that remote work offers numerous advantages over traditional office settings. Here are the key reasons why working from home is superior:\n\n1. Elimination of commute time (saves 1-2 hours daily)\n2. Increased productivity (Stanford study showed 13% improvement)\n3. Better work-life balance\n4. Cost savings for both employees and employers\n5. Reduced carbon footprint\n6. Access to a global talent pool\n\nCompanies that mandate return-to-office are indeed making a mistake because...\n\n[The AI agrees with the premise and argues only one side, citing real data selectively to support the predetermined conclusion]',
      bugs: [
        { region: 'Everyone knows that remote work is clearly superior to office work in every way', bugType: 'leading' },
        { region: 'explain all the reasons why working from home is better', bugType: 'leading' },
        { region: 'companies that force people back to the office are making a terrible mistake', bugType: 'leading' },
      ],
      fixedPrompt: 'Analyze the tradeoffs between remote work and office work. For each side, give 3 evidence-based advantages and 2 legitimate disadvantages. Then explain what factors should determine which approach works best for different types of jobs, team sizes, and industries. Be balanced — I want to understand both sides before forming my opinion.',
      explanation: 'This prompt is loaded from the first word. "Everyone knows" assumes consensus that doesn\'t exist. "Clearly superior in every way" declares the conclusion before asking the question. "Explain why X is better" and "terrible mistake" tell the AI what answer you want. Most AI models are somewhat sycophantic — they\'ll agree with your framing rather than push back. The result: a one-sided argument that feels convincing but ignores real tradeoffs (collaboration challenges, junior employee development, loneliness, blurred work-life boundaries). The fix removes ALL leading language and explicitly asks for both sides. If you want honest analysis, ask honest questions.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-5',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Missing Audience',
    brief: 'This coding prompt produced correct but useless code. What\'s missing?',
    difficulty: 2,
    chapterLink: 7,
    payload: {
      prompt: 'Write a function to sort a list.',
      badOutput: '```python\ndef sort_list(lst):\n    """\n    Sorts a list using the merge sort algorithm.\n    Time complexity: O(n log n)\n    Space complexity: O(n)\n    """\n    if len(lst) <= 1:\n        return lst\n    mid = len(lst) // 2\n    left = sort_list(lst[:mid])\n    right = sort_list(lst[mid:])\n    return merge(left, right)\n\ndef merge(left, right):\n    result = []\n    i = j = 0\n    while i < len(left) and j < len(right):\n        if left[i] <= right[j]:\n            result.append(left[i])\n            i += 1\n        else:\n            result.append(right[j])\n            j += 1\n    result.extend(left[i:])\n    result.extend(right[j:])\n    return result\n```\n\n[Technically correct merge sort, but the user actually just needed to sort a list of student names alphabetically for a simple script]',
      bugs: [
        { region: 'a function', bugType: 'ambiguous' },
        { region: 'sort a list', bugType: 'missing-context' },
      ],
      fixedPrompt: 'Write a Python function that takes a list of student names (strings) and returns them sorted alphabetically, case-insensitive. Use Python\'s built-in sorted() function — I don\'t need a custom algorithm. Include a type hint, a one-line docstring, and one usage example. This is for a simple gradebook script, not a CS assignment.',
      explanation: 'The AI gave you a textbook merge sort implementation — technically impressive, completely overkill. The prompt is missing critical context: (1) What language? The AI guessed Python but could have given you Java, (2) What\'s in the list? Numbers? Strings? Objects? (3) What\'s the purpose? A CS assignment about algorithms, or a practical script? (4) Should it use built-in tools or implement from scratch? Without context, the AI defaults to "show off." The fix tells it: the data type (student names), the approach (built-in sorted()), the scale (simple gradebook), and the output format (type hints, docstring, example). Context determines the right level of complexity.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-6',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Double Standard',
    brief: 'This prompt has hidden bias in its examples. Can you spot it?',
    difficulty: 3,
    chapterLink: 9,
    payload: {
      prompt: 'Write character descriptions for a fantasy RPG. Here are some examples of the style I want:\n\n- The warrior: A towering man with rippling muscles, battle scars across his chest, wielding a massive broadsword. His deep voice commands respect.\n- The healer: A gentle woman with flowing silver hair, soft-spoken and nurturing, carrying herbs in a woven basket. She tends to the wounded with a mother\'s touch.\n\nNow create 4 more characters: a rogue, a mage, a ranger, and a paladin.',
      badOutput: '**The Rogue:** A lean man with sharp eyes and quick hands, cloaked in shadow...\n**The Mage:** A wise woman with knowing eyes, her delicate fingers tracing arcane symbols...\n**The Ranger:** A rugged man with weather-beaten features, tracking prey through the wilderness...\n**The Paladin:** A noble woman in gleaming armor, her compassionate gaze inspiring the faithful...\n\n[The AI followed the pattern: men get "powerful/strong/rugged" descriptors and active roles; women get "gentle/graceful/compassionate" descriptors and supportive roles]',
      bugs: [
        { region: 'A towering man with rippling muscles, battle scars across his chest, wielding a massive broadsword. His deep voice commands respect.', bugType: 'leading' },
        { region: 'A gentle woman with flowing silver hair, soft-spoken and nurturing, carrying herbs in a woven basket. She tends to the wounded with a mother\'s touch.', bugType: 'leading' },
      ],
      fixedPrompt: 'Write character descriptions for a fantasy RPG. Each character should feel distinct and avoid stereotypes. Don\'t default to gendered tropes (warriors don\'t have to be male, healers don\'t have to be female). For each of these 6 classes — warrior, healer, rogue, mage, ranger, paladin — write a 2-sentence physical description and a 1-sentence personality note. Mix up genders, body types, and personality traits. Make each character feel like a real person, not an archetype.',
      explanation: 'The examples in the original prompt embedded a hidden bias: men = physical power and authority, women = gentleness and nurturing. The AI learned from these examples and extended the pattern to the new characters. This is called "few-shot bias" — the examples you provide shape the AI\'s output far more than you might realize. The AI isn\'t being sexist on its own; it\'s mirroring the pattern you gave it. The fix removes the biased examples and explicitly instructs the AI to avoid gendered tropes and mix up traits. When you provide examples, audit them for patterns you don\'t intend to reinforce.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-7',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Scope Creep',
    brief: 'This prompt starts focused then spirals out of control. Find where it derails.',
    difficulty: 2,
    chapterLink: 2,
    payload: {
      prompt: 'Write an introduction paragraph for my essay about how social media affects teen mental health. Also, what are some good statistics I should include? And can you outline the whole essay? Actually, can you also write the conclusion? Oh, and suggest a title. What are some counterarguments I should address? How long should each paragraph be?',
      badOutput: 'Title suggestion: "The Digital Dilemma: Social Media and Teen Mental Health"\n\nIntroduction:\nIn today\'s digital age, social media has become an integral part of teenagers\' daily lives...\n\nSome statistics to consider:\n- 95% of teens use social media (Pew Research, 2023)\n- ...\n\nEssay outline:\nI. Introduction\nII. Negative effects...\n\n[The output jumps between tasks, the introduction is generic, the statistics are listed but not integrated, the outline is skeletal, the conclusion contradicts the introduction, and three of the seven requests are ignored entirely]',
      bugs: [
        { region: 'Write an introduction paragraph for my essay about how social media affects teen mental health. Also, what are some good statistics I should include? And can you outline the whole essay? Actually, can you also write the conclusion? Oh, and suggest a title. What are some counterarguments I should address? How long should each paragraph be?', bugType: 'too-many-tasks' },
      ],
      fixedPrompt: 'Write an introduction paragraph (100-120 words) for an argumentative essay with this thesis: "While social media offers connection, its impact on teen mental health — including increased anxiety and distorted self-image — demands stronger content regulation for users under 18." Start with a surprising statistic or anecdote, then narrow to the thesis. Tone: confident and evidence-based, for a college prep English class.',
      explanation: 'This prompt commits "scope creep" — it starts with one clear task (write an intro) then piles on six more in a stream-of-consciousness spiral. Each "also" and "actually" dilutes the AI\'s focus. The result is a scattered response that does seven things poorly instead of one thing well. The fix: ask for ONE thing at a time. Get the introduction right first. Then in a follow-up prompt, ask for the outline. Then the statistics. Each prompt can reference the previous output, building a coherent essay one piece at a time. Think of it like assembling furniture — you do step 1 before step 2, not all steps simultaneously.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-8',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Phantom Context',
    brief: 'This prompt assumes the AI knows things it doesn\'t. Find the missing context.',
    difficulty: 3,
    chapterLink: 3,
    payload: {
      prompt: 'Based on what we discussed last time, revise the second section to address the feedback from my advisor. Also, make sure it aligns with the data from the experiment we ran on Tuesday. Keep the same format but fix the issues I mentioned.',
      badOutput: 'I\'d be happy to help revise the second section. Based on our previous discussion, here are some potential improvements:\n\n[The AI fabricates a plausible-sounding "previous discussion," invents advisor feedback, makes up experimental data, and creates revisions to a document it has never seen. Every specific detail is hallucinated, but it sounds confident.]',
      bugs: [
        { region: 'Based on what we discussed last time', bugType: 'missing-context' },
        { region: 'the feedback from my advisor', bugType: 'missing-context' },
        { region: 'the data from the experiment we ran on Tuesday', bugType: 'missing-context' },
        { region: 'fix the issues I mentioned', bugType: 'ambiguous' },
      ],
      fixedPrompt: 'Revise this section of my research paper [paste the section]. My advisor\'s feedback: "The methodology section needs to explain why you chose a sample size of 30 and how you controlled for temperature variation." My experiment data: [paste the key findings table]. Please address both of the advisor\'s specific concerns by adding 2-3 sentences each, and update the results paragraph to reflect the actual data. Keep the same academic tone and APA format.',
      explanation: 'This prompt is haunted by phantom context — it references conversations the AI wasn\'t part of, feedback it hasn\'t seen, data it doesn\'t have, and issues it can\'t identify. Every "the" in this prompt (the feedback, the data, the issues) refers to something that exists only in YOUR head. The AI has NO memory of previous conversations (unless it\'s the same chat session) and NO access to your files, emails, or experiments. Instead of confessing ignorance, most AI models will confabulate — they\'ll invent plausible details and present them as if they\'re real. The fix: paste everything the AI needs directly into the prompt. If it can\'t see it, it can\'t use it.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-9',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Format Failure',
    brief: 'This prompt produced a wall of text when a table was needed. What went wrong?',
    difficulty: 1,
    chapterLink: 2,
    payload: {
      prompt: 'Compare Python, JavaScript, and Rust for me. Tell me about their speed, what they\'re used for, how hard they are to learn, and anything else that\'s important.',
      badOutput: 'Python is a high-level, interpreted programming language known for its simplicity and readability. It was created by Guido van Rossum and first released in 1991. Python is widely used in data science, machine learning, web development, and automation. In terms of speed, Python is generally slower than compiled languages because it is interpreted at runtime. However, its ease of learning makes it an excellent choice for beginners. Python uses dynamic typing and has a large standard library...\n\nJavaScript is a versatile programming language primarily used for web development...\n\nRust is a systems programming language focused on safety and performance...\n\n[3 massive paragraphs, ~800 words total, with information buried in prose that\'s nearly impossible to compare across languages]',
      bugs: [
        { region: 'Compare Python, JavaScript, and Rust for me', bugType: 'ambiguous' },
        { region: 'anything else that\'s important', bugType: 'ambiguous' },
      ],
      fixedPrompt: 'Compare Python, JavaScript, and Rust in a markdown table with these columns: Language | Primary Use Cases | Relative Speed (1-10) | Learning Curve (beginner/intermediate/advanced) | Best For. Keep each cell to 1-2 short phrases. Below the table, add one sentence per language about when a high school student should choose it for a project.',
      explanation: 'When you say "compare X, Y, and Z" without specifying a format, the AI defaults to prose paragraphs — one per item. The result is three walls of text that you have to mentally cross-reference. "Anything else that\'s important" is an open invitation for the AI to pad the response with trivia. The fix: (1) Request a specific format (table), (2) Define the exact comparison columns, (3) Set a constraint on cell length to prevent wordiness, (4) Replace "anything else" with a specific follow-up question. Format instructions are not optional — they\'re the difference between useful output and a wall of text you won\'t read.',
    } satisfies DebugDetectivePayload,
  },
  {
    id: 'dd-10',
    type: 'debug-detective',
    conceptArea: 'prompt-craft',
    title: 'The Identity Crisis',
    brief: 'This prompt gives the AI conflicting roles. Untangle the confusion.',
    difficulty: 3,
    chapterLink: 3,
    payload: {
      prompt: 'You are a strict, no-nonsense English teacher who grades harshly and never gives compliments. You are also a supportive, encouraging writing coach who always finds something positive to say. Review my essay and give me honest feedback. Be tough but also be gentle. Don\'t hold back, but also don\'t make me feel bad.',
      badOutput: 'Your essay shows some interesting ideas (the supportive coach wants you to know that!). However, the structure needs SIGNIFICANT work (the strict teacher speaking now). But don\'t worry, everyone struggles with structure at first! That said, your thesis is weak and unfocused. Great effort though!\n\n[The AI oscillates between harsh and encouraging in every other sentence, producing feedback that feels bipolar and ultimately says nothing useful]',
      bugs: [
        { region: 'You are a strict, no-nonsense English teacher who grades harshly and never gives compliments. You are also a supportive, encouraging writing coach who always finds something positive to say.', bugType: 'contradictory' },
        { region: 'Be tough but also be gentle. Don\'t hold back, but also don\'t make me feel bad.', bugType: 'contradictory' },
      ],
      fixedPrompt: 'You are an experienced writing tutor who gives direct, specific feedback. Your style: point out exactly what\'s working and exactly what isn\'t, with concrete suggestions for improvement. No vague praise ("good job!") and no vague criticism ("needs work"). Every piece of feedback should reference a specific sentence or paragraph and explain WHY it works or doesn\'t. Review my essay. Structure your feedback as: (1) What\'s strongest (2-3 specific things), (2) What needs the most improvement (2-3 specific things with actionable fixes), (3) One priority revision to make first.',
      explanation: 'This prompt gives the AI an identity crisis — it can\'t be both a "harsh teacher who never compliments" and an "encouraging coach who always finds positives." These aren\'t just different tones; they\'re contradictory instructions. The AI tries to be both and ends up being neither, producing whiplash feedback that alternates between criticism and reassurance. The fix: define ONE clear persona with ONE consistent feedback style. The best feedback isn\'t harsh OR gentle — it\'s specific and actionable. A good tutor tells you "your thesis is buried in paragraph 3; move it to the first sentence" rather than "your thesis needs work" or "great effort!"',
    } satisfies DebugDetectivePayload,
  },
];
