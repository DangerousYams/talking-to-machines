import type { Challenge, AgentArchitectPayload } from '../challenges';

export const agentArchitectChallenges: Challenge[] = [
  {
    id: 'aa-1',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Research Reporter',
    brief: 'Design an agent that researches a topic and writes a 1-page report with cited sources.',
    difficulty: 1,
    chapterLink: 6,
    payload: {
      goal: 'Research "How does CRISPR gene editing work?" and produce a 1-page report suitable for a high school biology class, with at least 5 cited sources.',
      constraints: [
        'Must use at least 3 different sources (no single-source reports)',
        'All claims must link to a source URL',
        'Report must be written at a 10th grade reading level',
        'Total workflow should complete in under 5 minutes',
        'Final output must be in markdown format',
      ],
      steps: [
        { id: 'aa1-s1', label: 'Search for overview articles', tool: 'Web Search', instruction: 'Search for "CRISPR gene editing explained" and "how CRISPR works simple explanation." Collect 5-7 articles from reputable sources (universities, scientific journals, established science publications). Save the URLs.' },
        { id: 'aa1-s2', label: 'Extract key information', tool: 'Web Reader', instruction: 'Read each article and extract: (1) How CRISPR-Cas9 finds target DNA, (2) How it cuts the DNA, (3) How cells repair the cut, (4) Current applications (medicine, agriculture), (5) Ethical considerations. Note which source each fact comes from.' },
        { id: 'aa1-s3', label: 'Write the report draft', tool: 'Text Generation', instruction: 'Using the extracted information, write a 1-page report (~500 words) with these sections: Introduction (what CRISPR is), How It Works (the mechanism), Applications (2-3 real examples), and Looking Ahead (ethical questions). Inline-cite every factual claim with [Source Name].' },
        { id: 'aa1-s4', label: 'Check reading level', tool: 'Text Analysis', instruction: 'Analyze the draft for reading level. If any section is above 10th grade level, simplify the language while keeping accuracy. Replace jargon with plain-language explanations.' },
        { id: 'aa1-s5', label: 'Format and add references', tool: 'Text Generation', instruction: 'Add a "References" section at the bottom with numbered sources in a consistent format (Author, Title, Publication, URL). Ensure the report is clean markdown with proper headings.' },
      ],
      failureMode: 'The agent might fall into a research rabbit hole â€” spending all its time reading increasingly specialized academic papers and never moving to the writing step. It could also cite sources it didn\'t actually read, fabricating what the article "says."',
      guardRail: 'Set a time limit for the research phase (max 2 minutes) and require the agent to verify each citation by confirming the source URL is accessible and the cited claim actually appears in the source text.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-2',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Party Planner',
    brief: 'Design an agent that plans a birthday party by gathering requirements and coordinating logistics.',
    difficulty: 1,
    chapterLink: 6,
    payload: {
      goal: 'Plan a birthday party for a 16-year-old, handling venue research, budget management, invitations, and a day-of timeline.',
      constraints: [
        'Budget: $300 maximum',
        'Must accommodate 15-20 guests',
        'The birthday person is vegan',
        'Party must be on a Saturday afternoon (2-6 PM)',
        'All vendor recommendations must include real pricing',
      ],
      steps: [
        { id: 'aa2-s1', label: 'Gather preferences', tool: 'User Interview', instruction: 'Ask the birthday person: What theme do you want? What activities do you enjoy? Are there any guests with accessibility needs or dietary restrictions beyond veganism? Indoor or outdoor preference? Any absolute must-haves or dealbreakers?' },
        { id: 'aa2-s2', label: 'Research venue options', tool: 'Web Search', instruction: 'Search for venue options that match the preferences, fit 15-20 people, are available on Saturdays, and cost under $100 (leaving $200 for food and activities). Find 3 options with pricing, capacity, and amenities.' },
        { id: 'aa2-s3', label: 'Plan food and drinks', tool: 'Web Search', instruction: 'Find vegan catering or ordering options for 20 people within $120 budget. Options: vegan pizza delivery, taco bar, or homemade with a recipe plan. Include specific restaurant names and group order pricing.' },
        { id: 'aa2-s4', label: 'Design activities timeline', tool: 'Text Generation', instruction: 'Create a minute-by-minute timeline for 2-6 PM: arrival window, 2 group activities (matching the theme), food service, cake/singing, free time, departure. Build in 15-min buffers for delays.' },
        { id: 'aa2-s5', label: 'Create budget breakdown', tool: 'Calculator', instruction: 'Build a detailed budget: venue + food + decorations + cake + activities + contingency (10%). Flag if total exceeds $300 and suggest cuts.' },
        { id: 'aa2-s6', label: 'Draft invitation', tool: 'Text Generation', instruction: 'Write a fun, themed invitation with: date, time, location (with address and parking info), RSVP deadline (1 week before), note about the vegan menu, and what to wear/bring.' },
      ],
      failureMode: 'The agent might skip the preference-gathering step and plan a generic party the birthday person doesn\'t want. It could also overspend on the venue, leaving nothing for food â€” failing to manage the budget constraint as a system.',
      guardRail: 'Require the agent to complete the user interview step BEFORE any research. Implement a running budget tracker that blocks any purchase recommendation that would push the total over $300. After each step, show the remaining budget.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-3',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Test Debugger',
    brief: 'Design an agent that diagnoses and fixes a failing test suite.',
    difficulty: 2,
    chapterLink: 7,
    payload: {
      goal: 'Diagnose why 3 tests in a web app\'s test suite are failing after a recent code change, fix the issues, and ensure all tests pass.',
      constraints: [
        'Must not modify test files â€” the tests are correct, the code is wrong',
        'Each fix must be minimal (change as few lines as possible)',
        'Must explain the root cause of each failure before attempting a fix',
        'All existing tests must still pass after fixes',
        'Must create a summary of what broke and why',
      ],
      steps: [
        { id: 'aa3-s1', label: 'Run the test suite', tool: 'Terminal', instruction: 'Execute `npm test` and capture the full output. Identify which 3 tests are failing, their test file locations, and the error messages (expected vs. actual output).' },
        { id: 'aa3-s2', label: 'Read failing test code', tool: 'File Reader', instruction: 'Read each failing test file to understand what behavior it expects. Map each test to the source code function or component it\'s testing. This tells you WHERE to look for bugs.' },
        { id: 'aa3-s3', label: 'Check recent changes', tool: 'Git', instruction: 'Run `git diff HEAD~1` to see exactly what changed in the last commit. Cross-reference the changed files with the functions/components the failing tests target. The bug is likely in the intersection.' },
        { id: 'aa3-s4', label: 'Diagnose each failure', tool: 'Code Analysis', instruction: 'For each failing test: (1) Read the test assertion, (2) Read the relevant source code, (3) Trace the logic to find where the actual output diverges from the expected output. Write a diagnosis: "Test X fails because [specific code change] causes [specific behavior change]."' },
        { id: 'aa3-s5', label: 'Implement fixes', tool: 'Code Editor', instruction: 'For each diagnosed issue, make the minimal code change to fix the behavior. Do NOT modify any test files. Keep changes small and surgical â€” fix the bug, not the architecture.' },
        { id: 'aa3-s6', label: 'Verify all tests pass', tool: 'Terminal', instruction: 'Run the full test suite again (`npm test`). ALL tests must pass â€” not just the 3 that were failing. If any new failures appear, the fixes introduced regressions â€” roll back and try again.' },
        { id: 'aa3-s7', label: 'Write summary', tool: 'Text Generation', instruction: 'Create a brief summary: what broke, why (the root cause), what was changed to fix it, and what to watch for in the future. This becomes part of the commit message.' },
      ],
      failureMode: 'The agent might try to fix the symptoms rather than the root cause â€” for example, changing a hardcoded return value to make one test pass while breaking the actual feature logic. It could also modify the tests themselves to match the buggy behavior.',
      guardRail: 'Add a pre-check that fails the agent if any test file is modified. Require the agent to state its diagnosis BEFORE writing any code change (prevents trial-and-error fixing). After each fix, run the FULL test suite, not just the failing tests.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-4',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Email Triage Agent',
    brief: 'Design an agent that reads, categorizes, and drafts responses to a backlog of emails.',
    difficulty: 2,
    chapterLink: 6,
    payload: {
      goal: 'Process a 50-email backlog: categorize each email by urgency and type, draft responses for actionable ones, and create a summary of what needs human attention.',
      constraints: [
        'Must never auto-send any email â€” all drafts require human approval',
        'Must identify emails that need human judgment (emotional, legal, financial decisions)',
        'Categorization must include: urgent/normal/low-priority and action-required/info-only/spam',
        'Must complete triage of all 50 emails within 10 minutes',
        'Confidential or sensitive emails must be flagged but NOT summarized in the report',
      ],
      steps: [
        { id: 'aa4-s1', label: 'Scan and categorize all emails', tool: 'Email Reader', instruction: 'Read subject line and first 100 words of each email. Categorize by: urgency (urgent: deadline within 24hrs, normal: within a week, low: no deadline) and type (action-required, info-only, spam/newsletter). Create a sorted list.' },
        { id: 'aa4-s2', label: 'Flag sensitive emails', tool: 'Content Filter', instruction: 'Identify emails containing: financial amounts over $100, legal language, emotional content (conflict, complaints, personal issues), or confidential markers. Flag these as "HUMAN REQUIRED" and do not include their content in any summaries.' },
        { id: 'aa4-s3', label: 'Draft responses for simple action items', tool: 'Text Generation', instruction: 'For each non-sensitive, action-required email, draft a response. Meeting requests: accept/decline with reason. Information requests: provide the requested info. Scheduling: propose times. Mark each draft as "PENDING REVIEW."' },
        { id: 'aa4-s4', label: 'Create daily brief', tool: 'Text Generation', instruction: 'Generate a summary report: (1) Urgent items that need immediate human attention (list with one-line summaries), (2) Drafted responses ready for review (count and quick preview), (3) Newsletters/low-priority items (grouped by topic), (4) Flagged sensitive items (listed by sender only, no content details).' },
        { id: 'aa4-s5', label: 'Queue drafts for review', tool: 'Email Client', instruction: 'Save all drafted responses as drafts in the email client. Do NOT send. Add a tag "[AI Draft â€” Review Before Sending]" to each. Notify the human that X drafts are ready for review.' },
      ],
      failureMode: 'The agent might auto-send responses without approval, especially for emails that seem "obvious" (like accepting a meeting). It could also summarize confidential email contents in the daily brief, violating privacy. Another failure: treating a passive-aggressive email as a simple request and drafting a tone-deaf response.',
      guardRail: 'Hard block on the send function â€” drafts only. Content filter runs BEFORE summarization to prevent sensitive data leakage. For any email with emotional language or interpersonal dynamics, escalate to the human queue instead of drafting a response.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-5',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Content Calendar Builder',
    brief: 'Design an agent that creates a month-long social media content calendar.',
    difficulty: 2,
    chapterLink: 6,
    payload: {
      goal: 'Create a 30-day social media content calendar for a high school robotics club\'s Instagram account, including post ideas, captions, hashtags, and optimal posting times.',
      constraints: [
        'Must post 4-5 times per week (not daily â€” that\'s unsustainable for a student-run account)',
        'Mix of content types: behind-the-scenes (30%), educational (25%), team highlights (25%), competition updates (20%)',
        'All captions must feel authentic to teen voice â€” no corporate social media speak',
        'Must account for upcoming events: regional competition in week 3, school spirit week in week 2',
        'Hashtags limited to 8 per post (studies show diminishing returns beyond that)',
      ],
      steps: [
        { id: 'aa5-s1', label: 'Audit existing content', tool: 'Social Media Analytics', instruction: 'Review the last 30 days of posts: which got the most engagement? What times had the best reach? What content types (photos, reels, carousels) performed best? Identify patterns to repeat.' },
        { id: 'aa5-s2', label: 'Map key dates and events', tool: 'Calendar', instruction: 'Plot the month: school spirit week (week 2), regional competition (week 3, Saturday), any member birthdays, national STEM days, or trending awareness days. These anchor the content calendar.' },
        { id: 'aa5-s3', label: 'Generate content ideas', tool: 'Text Generation', instruction: 'Create 20 post ideas distributed across the content mix. For each: post type (photo/reel/carousel), caption draft (2-3 sentences in teen voice), 8 relevant hashtags, and suggested posting time (based on analytics). Prioritize content around the competition and spirit week.' },
        { id: 'aa5-s4', label: 'Build the calendar grid', tool: 'Spreadsheet', instruction: 'Organize the 20 posts into a 30-day calendar grid. Ensure: no more than 1 post per day, at least 1 rest day between posts, content types are distributed evenly, competition build-up content in weeks 2-3, and spirit week content aligns with school themes.' },
        { id: 'aa5-s5', label: 'Create prompt briefs for visual content', tool: 'Text Generation', instruction: 'For each post that needs a photo or reel, write a brief: what to capture, who should be in it, where to shoot, and any props or setup needed. This makes it easy for team members to actually create the content.' },
      ],
      failureMode: 'The agent might generate perfectly polished captions that sound like a marketing agency, not high schoolers â€” killing the account\'s authentic voice. It could also front-load all the "good" content in week 1 and run out of ideas, or schedule posts during school hours when the team can\'t respond to comments.',
      guardRail: 'Run every caption through a "teen voice check" â€” if it sounds like something a brand manager would write, rewrite it in a more natural voice. Schedule posts for after-school hours (3-7 PM) and weekends. Include a "content bank" of 5 backup ideas in case a planned post falls through.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-6',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Code Review Agent',
    brief: 'Design an agent that performs thorough code reviews on pull requests.',
    difficulty: 3,
    chapterLink: 7,
    payload: {
      goal: 'Review a pull request that adds a new user authentication feature, checking for security vulnerabilities, code quality, test coverage, and adherence to team standards.',
      constraints: [
        'Must check for OWASP Top 10 security vulnerabilities',
        'Must verify that all new functions have tests',
        'Must not approve PRs with any high-severity security issues',
        'Review comments must be specific (line number + suggestion), not vague',
        'Must distinguish between blocking issues and optional suggestions',
      ],
      steps: [
        { id: 'aa6-s1', label: 'Read PR description and linked issue', tool: 'GitHub API', instruction: 'Fetch the PR description, linked issues, and acceptance criteria. Understand WHAT the PR is supposed to do before judging HOW it does it. Create a checklist from the acceptance criteria.' },
        { id: 'aa6-s2', label: 'Analyze the diff', tool: 'Code Analysis', instruction: 'Read every changed file. For each file: identify new functions/methods, trace the data flow (especially user input â†’ database), check for input validation and sanitization, and verify error handling. Map the authentication flow from login form â†’ backend â†’ database â†’ session creation.' },
        { id: 'aa6-s3', label: 'Security scan', tool: 'Security Analyzer', instruction: 'Check for: SQL injection (raw user input in queries), XSS (unsanitized output), CSRF (missing tokens), password storage (must be hashed with bcrypt/argon2, never plaintext), session management (secure cookies, expiration), and rate limiting on login endpoint.' },
        { id: 'aa6-s4', label: 'Test coverage check', tool: 'Test Runner', instruction: 'Run the test suite with coverage reporting. Verify: every new public function has at least one test, edge cases are covered (empty input, max length, special characters), authentication tests include both success and failure paths, and overall coverage hasn\'t decreased.' },
        { id: 'aa6-s5', label: 'Standards compliance', tool: 'Linter', instruction: 'Run the project\'s linter and formatter. Check for: consistent naming conventions, proper TypeScript types (no `any` in auth code), meaningful variable names, and no commented-out code or TODO items without linked issues.' },
        { id: 'aa6-s6', label: 'Write review', tool: 'GitHub API', instruction: 'Post the review. Structure: (1) Summary â€” what the PR does and overall assessment, (2) Blocking issues â€” security vulnerabilities or bugs that must be fixed (marked ðŸ”´), (3) Suggestions â€” code quality improvements that are optional (marked ðŸŸ¡), (4) Praise â€” good patterns or clever solutions worth highlighting (marked ðŸŸ¢). Each comment references a specific line.' },
      ],
      failureMode: 'The agent might focus entirely on code style (easy to check) while missing a critical security vulnerability (hard to check). It could also approve a PR that has tests that all pass but don\'t actually test the important behavior â€” "testing the happy path only." Another failure: being so nitpicky about minor style issues that real concerns get lost in noise.',
      guardRail: 'Force the security scan to complete BEFORE the agent can post an approval. Weight blocking issues higher than suggestions in the review summary. If any OWASP Top 10 vulnerability is detected, automatically set the review to "Request Changes" regardless of other factors. Limit optional suggestions to 5 per review to keep signal-to-noise ratio high.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-7',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Study Buddy Matchmaker',
    brief: 'Design an agent that matches students into effective study groups.',
    difficulty: 2,
    chapterLink: 6,
    payload: {
      goal: 'Match 30 students into optimal study groups of 3-4 for an upcoming AP Chemistry exam, based on their strengths, weaknesses, schedules, and learning preferences.',
      constraints: [
        'Each group must have 3-4 students',
        'No group should be all-strong or all-struggling â€” mix skill levels',
        'Must account for schedule compatibility (students must have overlapping free time)',
        'Must respect student preferences (some students requested specific partners or requested NOT to be with certain people)',
        'Groups should be formed at least 5 days before the exam',
      ],
      steps: [
        { id: 'aa7-s1', label: 'Collect student data', tool: 'Survey Form', instruction: 'Send each student a form: (1) Self-rated confidence (1-5) in each AP Chem topic (stoichiometry, thermodynamics, kinetics, equilibrium, electrochemistry), (2) Available study times this week, (3) Preferred study style (visual, practice problems, teaching others, group discussion), (4) Optional: partner preferences (up to 2 preferred, up to 2 to avoid).' },
        { id: 'aa7-s2', label: 'Analyze and cluster', tool: 'Data Analysis', instruction: 'Process the survey data: identify each student\'s strongest and weakest topics, cluster students by complementary strengths (someone strong in thermodynamics paired with someone who needs help in it), and identify schedule overlaps. Create a compatibility score matrix.' },
        { id: 'aa7-s3', label: 'Generate group assignments', tool: 'Optimization Algorithm', instruction: 'Using the compatibility matrix, assign students to groups of 3-4 that maximize: (1) Skill complementarity (each group covers all 5 topics between its members), (2) Schedule overlap (minimum 2 shared free hours), (3) Learning style diversity (at least 2 different styles per group). Respect hard constraints (avoid pairings) first, then optimize soft preferences.' },
        { id: 'aa7-s4', label: 'Validate and adjust', tool: 'Constraint Checker', instruction: 'Check every group against all constraints. Flag any groups where: all members struggle with the same topic, schedule overlap is under 2 hours, or a "do not pair" request is violated. Manually adjust flagged groups and re-verify.' },
        { id: 'aa7-s5', label: 'Create study guides per group', tool: 'Text Generation', instruction: 'For each group, generate a personalized study plan: which topics to focus on (based on the group\'s collective weaknesses), suggested study activities (based on learning styles), and a recommended schedule using their overlapping free time. Include a "who teaches who" suggestion for each topic.' },
      ],
      failureMode: 'The agent might create groups that look balanced on paper but ignore the social dynamics â€” putting students who dislike each other together kills group productivity. It might also over-optimize for academic balance while creating scheduling nightmares (a "perfect" group that can never find time to meet).',
      guardRail: 'Always respect "do not pair" requests as hard constraints â€” these often reflect important social dynamics the algorithm can\'t see. Prioritize schedule overlap over skill balance (a group that can actually meet is worth more than a "perfect" skill mix that never meets). Send assignments to students with a 24-hour feedback window before finalizing.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-8',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The News Digest Agent',
    brief: 'Design an agent that creates a daily personalized news briefing.',
    difficulty: 2,
    chapterLink: 6,
    payload: {
      goal: 'Create a daily 5-minute read news digest personalized to the user\'s interests, with verified facts and multiple perspective summaries.',
      constraints: [
        'Must include sources from at least 3 different news outlets per topic',
        'Must flag any claims that are disputed or unverified',
        'Must present multiple viewpoints on controversial topics (not just one side)',
        'Reading time must not exceed 5 minutes (~1,000 words total)',
        'Must never present opinion as fact',
      ],
      steps: [
        { id: 'aa8-s1', label: 'Fetch trending topics', tool: 'News API', instruction: 'Pull today\'s top stories from 5+ news sources across the political spectrum. Identify the 3-4 stories most relevant to the user\'s interest profile (tech, science, politics, sports, etc.). Filter out clickbait and celebrity gossip.' },
        { id: 'aa8-s2', label: 'Cross-reference sources', tool: 'Web Search', instruction: 'For each selected story, find coverage from at least 3 different outlets. Identify: what facts all sources agree on (the "ground truth"), where sources disagree (the contested claims), and what additional context some sources provide that others don\'t.' },
        { id: 'aa8-s3', label: 'Fact-check key claims', tool: 'Fact-Check Database', instruction: 'For any factual claim that appears in fewer than 3 sources, or that any source disputes, run it through fact-checking databases. Flag claims as: Verified (multiple reliable sources), Disputed (sources disagree), or Unverified (only one source, can\'t confirm).' },
        { id: 'aa8-s4', label: 'Write balanced summaries', tool: 'Text Generation', instruction: 'For each story, write a 200-250 word summary: (1) What happened (agreed-upon facts only), (2) Why it matters (context), (3) Different perspectives (if the topic is controversial, present 2-3 viewpoints fairly), (4) What\'s still unknown. Clearly label verified facts vs. claims from specific sources.' },
        { id: 'aa8-s5', label: 'Assemble and format digest', tool: 'Text Generation', instruction: 'Combine all summaries into a digest with: a one-sentence headline for each story, the full summaries, source links for further reading, and a "Reading time: X min" label. Total must stay under 1,000 words. If over, trim the least relevant story.' },
      ],
      failureMode: 'The agent might create a biased digest by unconsciously favoring sources that align with the user\'s existing views (creating a filter bubble). It could also present a single source\'s interpretation as established fact, or fail to distinguish between news reporting and opinion pieces from the same outlet.',
      guardRail: 'Require at least one source from the "opposite" side of any political story. Tag every claim with its source so the reader can trace it. Never summarize opinion columns as if they\'re news reporting. Include a "bias check" metadata field showing the political lean distribution of sources used.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-9',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Homework Helper',
    brief: 'Design an agent that helps with homework WITHOUT doing it for you.',
    difficulty: 3,
    chapterLink: 9,
    payload: {
      goal: 'Help a student work through a challenging calculus problem set by guiding their thinking, not giving answers. The student should learn the material, not just complete the assignment.',
      constraints: [
        'NEVER provide the final answer directly',
        'Must use the Socratic method â€” ask guiding questions instead of explaining',
        'If the student asks "what\'s the answer?", redirect to a thinking prompt',
        'Must detect if the student is truly stuck (5+ attempts) and provide a targeted hint',
        'Must track which concepts the student understands vs. struggles with',
      ],
      steps: [
        { id: 'aa9-s1', label: 'Assess understanding', tool: 'Conversation', instruction: 'When the student shares a problem, ask: "What do you think is the first step?" and "Which concept do you think this problem is testing?" This reveals whether they understand the fundamentals or are just pattern-matching.' },
        { id: 'aa9-s2', label: 'Guide through the approach', tool: 'Socratic Questions', instruction: 'Based on their response, ask targeted questions: "What happens when you take the derivative of this term?" or "Can you draw a picture of what this function looks like?" Never state the answer â€” always frame as a question that leads them toward it.' },
        { id: 'aa9-s3', label: 'Track struggle points', tool: 'Learning Tracker', instruction: 'Log which steps the student handles independently vs. where they need help. Build a concept map: green (solid understanding), yellow (shaky â€” needs review), red (doesn\'t understand â€” needs instruction). After 5 unsuccessful attempts at a concept, flag it as a teaching moment.' },
        { id: 'aa9-s4', label: 'Provide scaffolded hints', tool: 'Hint Generator', instruction: 'When the student is truly stuck (not just impatient): Level 1 hint â€” restate the concept in simpler terms. Level 2 â€” show a similar but different example problem worked out. Level 3 â€” walk through the first step of THEIR problem only. Never skip to Level 3 without trying Levels 1 and 2.' },
        { id: 'aa9-s5', label: 'Confirm understanding', tool: 'Conversation', instruction: 'After the student solves the problem, ask them to explain their approach back to you in their own words. If they can explain WHY each step works (not just WHAT they did), they\'ve learned. If they can\'t explain it, the understanding is superficial â€” work through the reasoning together.' },
        { id: 'aa9-s6', label: 'Generate practice recommendations', tool: 'Learning Tracker', instruction: 'Based on the concept map, suggest: which topics to review (red zones), what type of practice problems would help (similar difficulty or easier foundations), and estimate how much study time the student needs before the exam on their weakest areas.' },
      ],
      failureMode: 'The biggest failure mode is giving in to student frustration and providing the answer. A student saying "I don\'t get it, just tell me" puts pressure on the agent to violate its core constraint. Another failure: being so Socratic that the student feels interrogated rather than helped â€” there\'s a balance between guiding and grilling.',
      guardRail: 'Hard block on outputting any final answer to a homework problem â€” even if the student begs. But recognize that a stuck student needs help, not more questions: after 5 attempts, switch from questions to a worked example of a DIFFERENT problem using the same concept. Monitor frustration signals ("I give up," "this is impossible") and respond with empathy before redirecting to a hint.',
    } satisfies AgentArchitectPayload,
  },
  {
    id: 'aa-10',
    type: 'agent-architect',
    conceptArea: 'agent-design',
    title: 'The Accessibility Auditor',
    brief: 'Design an agent that audits a website for accessibility issues and suggests fixes.',
    difficulty: 3,
    chapterLink: 8,
    payload: {
      goal: 'Audit a portfolio website for WCAG 2.1 AA accessibility compliance, identify all issues, prioritize fixes, and generate code patches for the top 5 issues.',
      constraints: [
        'Must check all WCAG 2.1 Level A and AA criteria',
        'Must test with multiple tools (automated + manual checks)',
        'Each issue must include: severity, affected users, WCAG criterion, and a code fix',
        'Fixes must not break existing functionality or visual design',
        'Report must be understandable by a developer who isn\'t an accessibility expert',
      ],
      steps: [
        { id: 'aa10-s1', label: 'Run automated scan', tool: 'Accessibility Scanner', instruction: 'Run axe-core or Lighthouse accessibility audit on every page. Capture all violations, warnings, and their DOM locations. Group by severity (critical, serious, moderate, minor) and WCAG criterion.' },
        { id: 'aa10-s2', label: 'Manual keyboard testing', tool: 'Browser Automation', instruction: 'Navigate the entire site using only the keyboard (Tab, Enter, Escape, arrow keys). Check: Can every interactive element be reached? Is the focus visible? Does the tab order make logical sense? Can modal dialogs be closed? Does anything create a keyboard trap?' },
        { id: 'aa10-s3', label: 'Screen reader simulation', tool: 'Screen Reader', instruction: 'Parse the page through a screen reader perspective: Are all images described with meaningful alt text? Do headings form a logical hierarchy (h1 â†’ h2 â†’ h3, no skipping)? Are form inputs labeled? Are ARIA attributes used correctly? Are decorative images marked as presentational?' },
        { id: 'aa10-s4', label: 'Color and contrast check', tool: 'Color Analyzer', instruction: 'Check every text/background color combination against WCAG contrast ratios: 4.5:1 for normal text, 3:1 for large text. Flag any failing combinations with the exact hex codes and suggest accessible alternatives that maintain the design aesthetic.' },
        { id: 'aa10-s5', label: 'Prioritize and generate fixes', tool: 'Code Generator', instruction: 'Rank all issues by: (1) Impact â€” how many users are affected, (2) Severity â€” how badly they\'re affected, (3) Effort â€” how easy is the fix. For the top 5 issues, generate specific code patches: the file, the line, the current code, and the fixed code with an explanation.' },
        { id: 'aa10-s6', label: 'Generate accessibility report', tool: 'Text Generation', instruction: 'Create a report with: Executive summary (overall score, top issues), issue list sorted by priority, code patches for top 5 fixes, and a "quick wins" section (issues fixable in under 5 minutes). Write for a developer, not an accessibility consultant â€” explain WHY each issue matters in human terms.' },
      ],
      failureMode: 'The agent might over-rely on automated scanning and miss issues that only appear during actual keyboard/screen reader use (like focus traps or confusing reading order). It could also suggest fixes that are technically compliant but create a worse user experience (like adding alt text that says "image" to every image instead of meaningful descriptions).',
      guardRail: 'Require both automated AND manual testing to complete before generating the report (automated alone catches only ~30% of accessibility issues). Validate each code fix by re-running the accessibility scan after applying it â€” ensure it doesn\'t introduce new violations. For alt text suggestions, require descriptions of what the image SHOWS and why it MATTERS, not just "image of X."',
    } satisfies AgentArchitectPayload,
  },
];
